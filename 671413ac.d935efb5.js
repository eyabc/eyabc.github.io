(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{227:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return i})),n.d(t,"default",(function(){return s}));var r=n(3),a=(n(0),n(447));const c={},o={unversionedId:"nest-js/overview/interceptor",id:"nest-js/overview/interceptor",isDocsHomePage:!1,title:"interceptor",description:"https://docs.nestjs.com/interceptors",source:"@site/docs/nest-js/overview/interceptor.mdx",slug:"/nest-js/overview/interceptor",permalink:"/docs/nest-js/overview/interceptor",version:"current",sidebar:"nestJs",previous:{title:"guards",permalink:"/docs/nest-js/overview/guards"},next:{title:"custom-decorators",permalink:"/docs/nest-js/overview/custom-decorators"}},i=[{value:"Basics",id:"basics",children:[]},{value:"ExecutionContext",id:"executioncontext",children:[]},{value:"Call handler",id:"call-handler",children:[]}],l={toc:i};function s({components:e,...t}){return Object(a.b)("wrapper",Object(r.a)({},l,t,{components:e,mdxType:"MDXLayout"}),Object(a.b)("p",null,Object(a.b)("a",{parentName:"p",href:"https://docs.nestjs.com/interceptors"},"https://docs.nestjs.com/interceptors")),Object(a.b)("p",null,Object(a.b)("img",{parentName:"p",src:"https://docs.nestjs.com/assets/Interceptors_1.png",alt:"interceptor"})),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"interceptor \uc758 \uc870\uac74")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"\ub2e4\uc74c \uc870\uac74\uc744 \ub9cc\uc871\ud558\ub294 \ud074\ub798\uc2a4\uc774\ub2e4."),Object(a.b)("ul",{parentName:"div"},Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"@Injectable()")," \ub85c \ub370\ucf54\ub808\uc774\ud130 \ub3fc\uc788\ub2e4."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"NestInterceptor")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud55c\ub2e4.")))),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Interceptors's AOP technique")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"Interceptors \ub294 Aspect Oriented Programming \uc5d0 \uc601\uac10\uc744 \ubc1b\uc558\ub2e4."),Object(a.b)("ul",{parentName:"div"},Object(a.b)("li",{parentName:"ul"},"\uba54\uc11c\ub4dc \uc2e4\ud589 \uc804\ud6c4\ub85c \ucd94\uac00\uc801\uc778\ub85c\uc9c1\uc744 \ubc14\uc778\ub4dc \ud560 \uc218 \uc788\ub2e4."),Object(a.b)("li",{parentName:"ul"},"\ud568\uc218\ub85c\ubd80\ud130 \ubc18\ud658\ub41c \uacb0\uacfc\ub97c \ubcc0\ud615\ud560 \uc218 \uc788\ub2e4."),Object(a.b)("li",{parentName:"ul"},"\ud568\uc218\ub85c\ubd80\ud130 \ub358\uc838\uc9c4 \uc608\uc678\ub97c \ubcc0\ud615\ud560 \uc218 \uc788\ub2e4."),Object(a.b)("li",{parentName:"ul"},"\uae30\ubcf8 \ud568\uc218\uc758 \ud589\uc704\ub97c \ud655\uc7a5\ud560 \uc218 \uc788\ub2e4."),Object(a.b)("li",{parentName:"ul"},"\ud2b9\uc815 \uc870\uac74\uc5d0 \uc758\uc874\ud558\uace0 \uc788\ub294 \ud568\uc218\ub97c \uc644\uc804\ud788 override \ud560 \uc218 \uc788\ub2e4. (e.g., for caching purposes)")))),Object(a.b)("h2",{id:"basics"},"Basics"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"interceptor \ub294 ",Object(a.b)("inlineCode",{parentName:"li"},"intercept()")," \ub97c \uad6c\ud604\ud55c\ub2e4.")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-typescript"},"/**\n * Interface providing access to the response stream.\n *\n * @see [Interceptors](https://docs.nestjs.com/interceptors)\n *\n * @publicApi\n */\nexport interface CallHandler<T = any> {\n    /**\n     * Returns an `Observable` representing the response stream from the route\n     * handler.\n     */\n    handle(): Observable<T>;\n}\n/**\n * Interface describing implementation of an interceptor.\n *\n * @see [Interceptors](https://docs.nestjs.com/interceptors)\n *\n * @publicApi\n */\nexport interface NestInterceptor<T = any, R = any> {\n    /**\n     * \ucee4\uc2a4\ud140 Interceptor \uc758 implement \uc744 \uc704\ud55c \uba54\uc11c\ub4dc\n     *\n     * @param context an `ExecutionContext` object providing methods to access the\n     * route handler and class about to be invoked.\n     * @param next a reference to the `CallHandler`, which provides access to an\n     * `Observable` representing the response stream from the route handler.\n     */\n    intercept(context: ExecutionContext, next: CallHandler<T>): Observable<R> | Promise<Observable<R>>;\n}\n")),Object(a.b)("h2",{id:"executioncontext"},"ExecutionContext"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"ArgumentsHost \ub97c \ud655\uc7a5\ud558\uba70, \uc0c8\ub85c\uc6b4 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub97c \uac00\uc9c4\ub2e4.",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"\ud604\uc7ac \uc2e4\ud589 \ud504\ub85c\uc138\uc2a4\uc758 \uc138\ubd80\uc815\ubcf4\ub97c \uac00\uc9c4\ub2e4.",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"Controller, Methods, Execution Contexts \uc5d0\uc11c \uad11\ubc94\uc704\ud558\uac8c \uc791\ub3d9\ud560\uc218 \uc788\ub294 generic \ud55c interceptors \ub97c \ub9cc\ub4e4 \uc218 \uc788\ub2e4.")))))),Object(a.b)("h2",{id:"call-handler"},"Call handler"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("inlineCode",{parentName:"p"},"CallHandler")," \uc778\ud130\ud398\uc774\uc2a4\ub294 ",Object(a.b)("inlineCode",{parentName:"p"},"handle()")," \uc744 \uad6c\ud604\ud55c\ub2e4."),Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"handle()")," \ub294 Interceptor \uc5d0\uc11c \uc6d0\ud558\ub294 \uc2dc\uc810\uc5d0, Route Handler \uba54\uc11c\ub4dc\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\uac8c \ud574\uc900\ub2e4."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"handle()")," \uc744 \uad6c\ud604\ud558\uc9c0 \uc54a\uc73c\uba74, Route Handler \uba54\uc11c\ub4dc\ub294 \uc2e4\ud589\ub418\uc9c0 \uc54a\ub294\ub2e4."))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("inlineCode",{parentName:"p"},"intercept()")," \uba54\uc11c\ub4dc\ub294 \ud6a8\uc728\uc801\uc73c\ub85c Request/Response \uc2a4\ud2b8\ub9bc\uc744 \ub798\ud551\ud55c\ub2e4.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"\uadf8 \uacb0\uacfc,\nAs a result, you may implement custom logic both before and after the execution\nof the final route handler."))),Object(a.b)("p",null,"It's clear that you can write code in your intercept() method that executes before calling handle(), but how do you affect what happens afterward? Because the handle() method returns an Observable, we can use powerful RxJS operators to further manipulate the response. Using Aspect Oriented Programming terminology, the invocation of the route handler (i.e., calling handle()) is called a Pointcut, indicating that it's the point at which our additional logic is inserted."))}s.isMDXComponent=!0},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),p=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},b=function(e){var t=p(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,c=e.originalType,o=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),b=p(n),u=r,m=b["".concat(o,".").concat(u)]||b[u]||d[u]||c;return n?a.a.createElement(m,i(i({ref:t},s),{},{components:n})):a.a.createElement(m,i({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=n.length,o=new Array(c);o[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var s=2;s<c;s++)o[s]=n[s];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);