<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mindfulness Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mindfulness Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Mindfulness" href="/opensearch.xml"><title data-react-helmet="true">Jooq Tricks | Mindfulness</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Jooq Tricks | Mindfulness"><meta data-react-helmet="true" name="description" content="3.11.9 ë²„ì „ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤."><meta data-react-helmet="true" property="og:description" content="3.11.9 ë²„ì „ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤."><meta data-react-helmet="true" property="og:url" content="https://eyabc.github.io/docs/java/jooq/jooq_tricks"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://YGAFWBIY5W-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://eyabc.github.io/docs/java/jooq/jooq_tricks"><link rel="stylesheet" href="/styles.3ada4974.css">
<link rel="preload" href="/styles.b715cea4.js" as="script">
<link rel="preload" href="/runtime~main.01bf3f2f.js" as="script">
<link rel="preload" href="/main.f85ec068.js" as="script">
<link rel="preload" href="/1.878c926c.js" as="script">
<link rel="preload" href="/3.052ff86c.js" as="script">
<link rel="preload" href="/1be78505.641b6934.js" as="script">
<link rel="preload" href="/412.ad32a78c.js" as="script">
<link rel="preload" href="/935f2afb.0a816309.js" as="script">
<link rel="preload" href="/409.2e79ec87.js" as="script">
<link rel="preload" href="/17896441.12f0be0b.js" as="script">
<link rel="preload" href="/3f987819.89f0bf38.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self" href="/docs/javascript/javascript/index">JavaScript</a><ul class="dropdown__menu"><li><a class="dropdown__link" type="doc" docid="nest-js" target="_self" href="/docs/nest-js/index">Nest JS</a></li><li><a class="dropdown__link" type="doc" docid="dev-settings" target="_self" href="/docs/javascript/dev-settings/index">dev-settings</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self" href="/docs/java/index">Java</a><ul class="dropdown__menu"><li><a class="dropdown__link" type="doc" docid="effective-java" target="_self" href="/docs/java/effective-java">Effective Java</a></li><li><a class="dropdown__link" type="doc" docid="java-spring" target="_self" href="/docs/java/spring/index">Spring</a></li><li><a class="dropdown__link" type="doc" docid="java-etc" target="_self" href="/docs/java/etc/index">etc</a></li></ul></div><a class="navbar__item navbar__link" target="_self" href="/docs/css/index">CSS</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self" href="/docs/dev-etc/index">Dev etc</a><ul class="dropdown__menu"><li><a class="dropdown__link" type="doc" docid="HTML" target="_self" href="/docs/html/index">HTML</a></li><li><a class="dropdown__link" type="doc" docid="network" target="_self" href="/docs/network/HTTP_headers_Referer_ë³´ì•ˆì´ìŠˆ">Network</a></li><li><a class="dropdown__link" type="doc" docid="os" target="_self" href="/docs/os/index">OS</a></li></ul></div><a class="navbar__item navbar__link" target="_self" href="/docs/infra/index">Infra</a><a class="navbar__item navbar__link" docid="Database" target="_self" href="/docs/database/index">Database</a><a class="navbar__item navbar__link" target="_self" href="/docs/consultant/index">Consultant</a><a class="navbar__item navbar__link" target="_self" href="/blog">Blog</a><a class="navbar__item navbar__link" target="_self" href="/docs/study/dku-javascript">Study</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/eyabc/eyabc.github.io" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">ë‘ë ¤ì›Œë„ ì¤‘ìš”í•˜ë‹¤ë©´ ì‹œë„í•´ë´ì•¼ í•˜ì§€ ì•Šê² ëŠ”ê°€</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" target="_self" href="/docs/javascript/javascript/index">JavaScript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" type="doc" docid="nest-js" target="_self" href="/docs/nest-js/index">Nest JS</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="dev-settings" target="_self" href="/docs/javascript/dev-settings/index">dev-settings</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" target="_self" href="/docs/java/index">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" type="doc" docid="effective-java" target="_self" href="/docs/java/effective-java">Effective Java</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="java-spring" target="_self" href="/docs/java/spring/index">Spring</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="java-etc" target="_self" href="/docs/java/etc/index">etc</a></li></ul></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/css/index">CSS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" target="_self" href="/docs/dev-etc/index">Dev etc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" type="doc" docid="HTML" target="_self" href="/docs/html/index">HTML</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="network" target="_self" href="/docs/network/HTTP_headers_Referer_ë³´ì•ˆì´ìŠˆ">Network</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="os" target="_self" href="/docs/os/index">OS</a></li></ul></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/infra/index">Infra</a></li><li class="menu__list-item"><a class="menu__link" docid="Database" target="_self" href="/docs/database/index">Database</a></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/consultant/index">Consultant</a></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/eyabc/eyabc.github.io" target="_self" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/study/dku-javascript">Study</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/java/index">java</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/compareTo_equals">compareTo_equals</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Lombok</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/java/lombok/data">Lombok - @Data</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ìë£Œêµ¬ì¡°</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/java/data_structure/Set">Set</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/java/data_structure/Map">Map</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">JOOQ</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/java/jooq/jooq_tricks">Jooq Tricks</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/transient_fields">transient fields ì„ì‹œ í•„ë“œ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/public_suffix_list">Public Suffix List (PSL)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/JDBC">JDBC</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/package_module">package_module</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/java/jacksonJSONLibrary">jacksonJSONLibrary</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">Jooq Tricks</h1></header><div class="markdown"><p>3.11.9 ë²„ì „ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p><ol><li>BaseRepository ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ê³µí†µìœ¼ë¡œ í™•ì¥í•©ë‹ˆë‹¤.</li></ol><p>JPA ì˜ <code>findById</code> ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ê¹Œ ê³ ë¯¼í•˜ì˜€ìŠµë‹ˆë‹¤.</p><p>í…ŒìŠ¤íŠ¸ì½”ë“œì—ì„œ,
BaseRepository ë¥¼ í™•ì¥í•œ Repository Map ì„ ì£¼ì…ë°›ì•„ ê°€ì ¸ì˜¨ ë‹¤ìŒ, truncate ë©”ì„œë“œë¥¼
ì‹¤í–‰ì‹œì¼œì£¼ê¸° ìœ„í•´ BaseRepository ë¥¼ ìƒì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>í…Œì´ë¸”ìµœì í™”ë¥¼ ìœ„í•œ ì‘ì—…ìœ¼ë¡œ í…Œì´ë¸” ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆì„ ê²½ìš°, ì½”ë“œì˜ ë§ì€ ë¶€ë¶„ì„ ë³€ê²½í•´ ì£¼ì—ˆì–´ì•¼ í–ˆìŠµë‹ˆë‹¤.
ì œë„ˆë¦­ í´ë˜ìŠ¤ë¥¼ <code>class BaseRepository&lt;T extends Table&gt;</code> ì‚¬ìš©í•˜ì—¬ ì¶”ìƒ ë©¤ë²„ ë³€ìˆ˜ì— <code>public final T TABLE;</code>
ì„ ì„ ì–¸í•˜ê³ , í™•ì¥í•˜ëŠ” í´ë˜ìŠ¤ì—ì„œ <code>public class TableDaoJooqImpl extends BaseRepository&lt;JTable, JTableRecord&gt;</code>
ì œë„ˆë¦­ íƒ€ì…ë§Œ ë³€ê²½í•´ì£¼ì–´, í…Œì´ë¸” Migration ì‹œ, ì½”ë“œ ë³€ê²½ì„ ìµœì†Œí™” í•˜ëŠ” ë°©ì•ˆìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Slf4j</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@AllArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@RequiredArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public abstract class BaseRepository&lt;T extends Table, R extends Record&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public final T TABLE;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  protected final DSLContext writeContext;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  protected final DSLContext readContext;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  // ...</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code> protected final DSLContext writeContext;</code>  <code>protected final DSLContext readContext</code> ì€
ë°ì´í„° ì†ŒìŠ¤ë¥¼ Master ì™€ Slave ë¡œ ë‚˜ë‰˜ì–´ì ¸ ì‚¬ìš©í•  ê²½ìš°, êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í•˜ë‚˜ì˜ ë°ì´í„°ì†ŒìŠ¤ë§Œì„ ì‚¬ìš©í•  ë•,
bean ì˜ Qualify ë¡œ writeContext, readContext ëª¨ë‘ êµ¬í˜„í•œ í›„ ë™ì¼í•œ ë°ì´í„°ì†ŒìŠ¤ ì„¤ì •ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í˜¹ì€ DSLContext ë¥¼ í•˜ë‚˜ë§Œ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´ ë©ë‹ˆë‹¤.</p><p>íŠ¸ëœì­ì…˜ì„ bean ì„ êµ¬í˜„í•´, readContext ì´ë¦„ìœ¼ë¡œ ë¹ˆì„ ì£¼ì…ë°›ì•„ë„, ì„¤ì •í•œ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¡œ Master ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³ ,
ë°˜ëŒ€ë¡œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Repository</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class TableDaoJooqImpl extends BaseRepository&lt;JTable, JTableRecord&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    implements TableDao {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public TableDaoJooqImpl( DSLContext writeContext, DSLContext readContext) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        super(JTable.TABLE, writeContext, readContext);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="2"><li>BaseRepository ì˜ ë©”ì„œë“œëŠ” í™•ì¥í•˜ëŠ” í´ë˜ìŠ¤ëŠ” ì¤‘ë³µì ìœ¼ë¡œ ì‘ì„±ë˜ëŠ” java code ë¥¼ ì¤„ì˜€ìŠµë‹ˆë‹¤.
ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ, Pojo ê°ì²´ë‚˜, Jooq ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤.
ì¶”ìƒí™” ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©ì— í•­ìƒ ì£¼ì˜í•´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.
ì„¤ëª…ì´ ë˜ì–´ ìˆì§€ ì•Šì€ ì˜ˆìƒë˜ì§€ ì•ŠëŠ” ë™ì‘ì´ ë°œìƒí•  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì—,
ë” êµ¬ì²´ì ì¸ ì£¼ì„ì´ í•„ìš”í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public abstract class BaseRepository&lt;T extends Table, R extends Record&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public final T TABLE;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  protected final DSLContext writeContext;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  protected final DSLContext readContext;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public void fetchSql(String sql) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    writeContext.fetch(sql);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public void deleteAll() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    writeContext.delete(TABLE).execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  // ì“°ì§€ë§ê²ƒ! ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì‚¬ìš©</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public void truncate() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // writeContext.truncate(TABLE).execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Deprecated</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public Result&lt;Record&gt; convertListToResult(List&lt;? extends Record&gt; list) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Result&lt;Record&gt; fetch = readContext.selectFrom(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .limit(0)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .fetch();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    fetch.addAll(list);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return fetch;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public &lt;E&gt; Result&lt;Record&gt; saveAll(List&lt;E&gt; list) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;Record&gt; collect = list.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .map(this::save)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return convertListToResult(collect);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @SuppressWarnings(&quot;unchecked&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public void insertOnDuplicateKeyUpdate(R record) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    writeContext.insertInto(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .onDuplicateKeyUpdate()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  //  pojo ì˜ null ì¸ ê°’ì€ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šê²Œí•¨. pojo ë¡œ Insert, Update Delete í•  ë•Œ ê¼­ ì‚¬ìš©í•´ì•¼í•¨.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public R newRecordIncludeNonNull(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    R newRecord = (R) readContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;Field&gt; fields = newRecord.fieldsRow().fieldStream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .map(r -&gt; TABLE.field(r.getName()))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    AtomicInteger i = new AtomicInteger(-1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    newRecord.valuesRow().fieldStream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .forEach(a -&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        i.addAndGet(1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (Objects.equals(a.getName(), &quot;null&quot;)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          newRecord.changed(fields.get(i.get()), false);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      });</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return newRecord;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public R newRecord(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return (R) readContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public &lt;POJO&gt; void insertOnDuplicateKeyUpdate(POJO pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    R record = (R) writeContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    insertOnDuplicateKeyUpdate(record);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public &lt;POJO&gt; void insertOnDuplicateKeyUpdate(POJO pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    R record = (R) writeContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    insertOnDuplicateKeyUpdate(record);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public InsertSetMoreStep&lt;?&gt; setInsertPrimaryKey(InsertSetStep&lt;?&gt; insertSetStep) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return (InsertSetMoreStep&lt;?&gt;) insertSetStep;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Deprecated // ì½”ë“œê°€ ë„ˆë¬´ ë³µì¡í•´ì§</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public &lt;E&gt; Condition primaryCondition(E item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    throw new AssertionError(&quot;override primaryCondition!&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Deprecated</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public int update(R item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return writeContext.update(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .set(item)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .where(primaryCondition(item))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public void update(List&lt;R&gt; item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    for (R r : item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      update(r);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  /**</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">   * @param item</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">   * @param condition</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">   * @return the number of updated records</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">   */</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public int update(R item, Condition condition) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return writeContext.update(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .set(item)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .where(condition)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Deprecated</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public &lt;E&gt; Optional&lt;Record&gt; getByPrimaryCondition(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    E item,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;TableField&lt;?, ?&gt;&gt; selectors</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  ) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return readContext.select(selectors)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .from(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .where(primaryCondition(item))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .fetchOptional();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Deprecated</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public Optional&lt;R&gt; getByPrimaryCondition(R item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return readContext.selectFrom(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .where(primaryCondition(item))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .fetchOptional();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public List&lt;Field&lt;Object&gt;&gt; convertNamesToJooqFields(List&lt;String&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return selectors.stream().map(DSL::field)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private SelectConditionStep&lt;Record&gt; addConditionToSelectStep(R record,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    SelectConditionStep&lt;Record&gt; where) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;Object&gt; values = new ArrayList&lt;&gt;(record.map(r -&gt; r)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .intoMap()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .values());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Row fieldsRow = record.fieldsRow();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    for (Object o : values) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      if (isNull(o)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        continue;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int index = values.indexOf(o);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      where = where.and(((Field&lt;Object&gt;) fieldsRow.field(index)).eq(o));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return where;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public SelectConditionStep&lt;Record&gt; findBySelectorAndPojo(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;String&gt; selectors,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Object pojo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  ) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;Field&lt;Object&gt;&gt; fields = convertNamesToJooqFields(selectors);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    SelectConditionStep&lt;Record&gt; where = readContext.select(fields).from(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .where();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return addConditionToSelectStep(newRecordIncludeNonNull(pojo), where);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public SelectConditionStep&lt;Record&gt; findByPojo(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return addConditionToSelectStep(newRecordIncludeNonNull(pojo), readContext.selectFrom(TABLE).where());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Map&lt;? extends Table&lt;?&gt;, List&lt;TableField&lt;?, ?&gt;&gt;&gt; selectorsTableMapper(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;TableField&lt;?, ?&gt;&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return selectors.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(groupingBy(TableField::getTable));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  static Map&lt;Table, ? extends List&lt;? extends Field&lt;?&gt;&gt;&gt; selectorsFieldTableMapper(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;? extends Field&lt;?&gt;&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return selectors.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(groupingBy(r -&gt; ((TableField) r).getTable()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ì˜ˆì œ"></a>ì˜ˆì œ<a class="hash-link" href="#ì˜ˆì œ" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="fetchstring-sql"></a>fetch(String sql)<a class="hash-link" href="#fetchstring-sql" title="Direct link to heading">#</a></h4><p>sql íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¬ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void fetchSql(String sql) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  writeContext.fetch(sql);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Slf4j</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@RequiredArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Service</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class TestDBService {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private final ObjectMapper objectMapper;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private final Map&lt;String, BaseRepository&gt; baseRepositories;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    @Transactional</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void init() throws IOException, SQLException {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        clear(new ArrayList&lt;&gt;(baseRepositories.values()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        // readStub ëŠ” sql íŒŒì¼ì„ String ìœ¼ë¡œ ì½ì–´ì˜¤ëŠ” ë©”ì„œë“œ ì…ë‹ˆë‹¤.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        for (String sql : readStub(STUB_PATH + &quot;insert-common-db.sql&quot;).split(&quot;;&quot;)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            baseRepositories.get(&quot;tableDao&quot;).fetchSql(sql);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="delete-or-truncate"></a>delete or truncate<a class="hash-link" href="#delete-or-truncate" title="Direct link to heading">#</a></h4><p>ë‘ ë©”ì„œë“œëŠ” ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ì½”ë“œì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ë„ë¡ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void deleteAll() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  writeContext.delete(TABLE).execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void truncate() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  writeContext.truncate(TABLE).execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>BaseRepository ë¥¼ í™•ì¥í•œ í…Œì´ë¸”ë“¤ì˜ ë ˆì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void clear(List&lt;BaseRepository&gt; repositories) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    LinkedList&lt;BaseRepository&lt;?, ?&gt;&gt; q = new LinkedList(repositories);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    int count = 0;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    while (true) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (q.size() == 0 || count == 100) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            break;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        BaseRepository el = null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        try {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            el = q.remove();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            el.deleteAll();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } catch (DataAccessException e) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            q.offer(el);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } catch (NoSuchElementException e) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            log.info(&quot;delete BaseRepository data finished! success&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            break;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } catch (Exception e) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            log.info(&quot;delete BaseRepository data error!&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            break;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } finally {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            count++;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="convert-list-to-jooq-result-record"></a>convert List to Jooq Result Record<a class="hash-link" href="#convert-list-to-jooq-result-record" title="Direct link to heading">#</a></h4><p>ì–´ë– í•œ ì‚¬ì •ìœ¼ë¡œ List ë¥¼ Result ë§¤ê°œë³€ìˆ˜ ë©”ì„œë“œì˜ ì¸ìë¡œ ë„˜ê²¨ì•¼ í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì“°ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. Mysql ì„ ì‚¬ìš©í•˜ë‹¤ê°€, ë‹¤ë¥¸ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•´ì•¼ í•  ë•Œ Jooq ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ë©´
ì½”ë“œ ì „ë°˜ì— í©ì–´ì§„, jooq ê°ì²´ë¥¼ input output ìœ¼ë¡œ ì£¼ê³ ë°›ëŠ” ë‹¤ë©´, ì½”ë“œë¥¼ ìˆ˜ìŠµí•´ì•¼ í•  ì¼ì´ ìƒê¸´ë‹¤ë©´ ì–´ë–¡í•´ì•¼ í• ê¹Œìš”
Pojo ê°ì²´ë¡œ ì£¼ê³  ë°›ëŠ”ê²ƒì´ ì´ë¡œìš¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Deprecated</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public Result&lt;Record&gt; convertListToResult(List&lt;? extends Record&gt; list) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Result&lt;Record&gt; fetch = readContext.selectFrom(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .limit(0)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .fetch();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  fetch.addAll(list);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return fetch;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ì´ ë©”ì„œë“œì˜ ì¥ì ì´ í•˜ë‚˜ ìˆìŠµë‹ˆë‹¤.
table1 ê³¼ table2 ê°€ ìˆì„ ë•Œ, ë‘ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ìŠ¤í‚¤ë§ˆê°€ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤.
table1 ì˜ ë ˆì½”ë“œë¥¼ table2 ë¡œ ì €ì¥í•˜ëŠ” ê²ƒì„ êµ¬í˜„í•´ì•¼ í•  ë•Œ,
table1 ì˜ jooq ë ˆì½”ë“œë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ <code>into(TABLE2)</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ table2 ê°ì²´ë¡œ ë³€í™˜ì´ ìš©ì´í•˜ê¸° ë•Œë¬¸ì—
table2 ì— ì €ì¥í•˜ëŠ” ê²ƒì´ ê°„í¸í•©ë‹ˆë‹¤.
í•˜ì§€ë§Œ ì¤‘ê°„ì— table1 ë ˆì½”ë“œë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ, jooq ë©”ì„œë“œì˜ í•œê³„ë¡œ list íƒ€ì…ì„ ë°˜ë“œì‹œ ê±°ì³ì•¼ë§Œ í•œë‹¤ë©´,
list íƒ€ì…ì˜ table1 ìš”ì†Œë¥¼ table2 ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ ë•Œ convertListToResult ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ jooq ì˜ result íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œ ì¥ì ì„ ëˆ„ë¦´ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í¸ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ë²ˆê±°ë¡­ë”ë¼ë„ Pojo ë¥¼ ì‚¬ìš©í•˜ë©´ ë” ì¢‹ì„ ê²ƒ ê°™ê¸° ë•Œë¬¸ì— @Deprecated í•˜ì—¬, ì½”ë“œë¥¼ ì •ë¦¬í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="save-í•œ-ê²°ê³¼ë¥¼-ë¦¬í„´"></a>save í•œ ê²°ê³¼ë¥¼ ë¦¬í„´<a class="hash-link" href="#save-í•œ-ê²°ê³¼ë¥¼-ë¦¬í„´" title="Direct link to heading">#</a></h4><p><code>List&lt;E&gt;</code> ì˜ E ëŠ” í˜¸ì¶œë  ë•Œ JTableRecord íƒ€ì… ì´ë©° Record íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ í•©ë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public &lt;E&gt; Result&lt;Record&gt; saveAll(List&lt;E&gt; list) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;Record&gt; collect = list.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .map(this::save)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return convertListToResult(collect);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void saveAll(List&lt;JTableRecord&gt; list) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    tableDao.saveAll(list);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public &lt;E&gt; Record save(E item) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  UpdatableRecord&lt;?&gt; record = (UpdatableRecord&lt;?&gt;) writeContext.newRecord(TABLE, item);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  record.store();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return record;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public JTableRecord insertNew() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    JTableRecord record  = new JTableRecord();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    record.setA(a);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    record.setB(b);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return save(record).into(TABLE);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="insertonduplicatekeyupdate"></a>insertOnDuplicateKeyUpdate<a class="hash-link" href="#insertonduplicatekeyupdate" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@SuppressWarnings(&quot;unchecked&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void insertOnDuplicateKeyUpdate(R record) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  writeContext.insertInto(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .onDuplicateKeyUpdate()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void insertOnDuplicateKeyUpdate(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  writeContext.insertInto(writeContext.newRecord(TABLE, pojo))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .onDuplicateKeyUpdate()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .set(record)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void insertOnDuplicateKeyUpdate(TablePojo tablePojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    super.insertOnDuplicateKeyUpdate(writeContext.newRecord(TABLE, tablePojo));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pojo-ê°ì²´ë¥¼-jooq-ê°ì²´ë¥¼-ëŒ€ì‹ í•˜ì—¬-cud-ìˆ˜í–‰í•˜ê¸°-ìœ„í•œ-ë©”ì„œë“œ"></a>Pojo ê°ì²´ë¥¼ Jooq ê°ì²´ë¥¼ ëŒ€ì‹ í•˜ì—¬ CUD ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ë©”ì„œë“œ<a class="hash-link" href="#pojo-ê°ì²´ë¥¼-jooq-ê°ì²´ë¥¼-ëŒ€ì‹ í•˜ì—¬-cud-ìˆ˜í–‰í•˜ê¸°-ìœ„í•œ-ë©”ì„œë“œ" title="Direct link to heading">#</a></h4><p>Pojo ê°ì²´ì— null ì´ ì•„ë‹Œ ê°’ë“¤ë§Œ insert í•˜ê±°ë‚˜, update í•˜ê±°ë‚˜ delete ë¥¼ í•˜ê¸° ìœ„í•œ ì¡°ê±´ìœ¼ë¡œ ì§€ì •í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
pojo ê°ì²´ë¥¼ ë„ë©”ì¸ ê°ì²´ë¡œ ë˜í•‘í•˜ê³ , ë˜í•‘í•œ ê°ì²´ë¥¼ <code>new JTableRecord()</code> í•˜ì—¬ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©í•œ ê°’ë“¤ì˜ setter ë¥¼ í˜¸ì¶œí•  ìˆ˜ë„ ìˆì§€ë§Œ,
Pojo ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Pojo ê°ì²´ë¥¼ newRecord ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³€í™˜í•  ê²½ìš°, null ì´ì§€ë§Œ
Table ìŠ¤í‚¤ë§ˆì— null ì¼ ê²½ìš° ê¸°ë³¸ê°’ì´ ì§€ì •ë˜ì–´ ìˆì„ ë•Œ, Pojo ê°ì²´ì— null ìœ¼ë¡œ ë˜ì–´ ìˆì§€ë§Œ default ê°’ì´ ìë™ìœ¼ë¡œ ì„¸íŒ…ë©ë‹ˆë‹¤.
ì´ëŸ´ ë•Œ default ê°’ì´ ì¡°ê±´ìœ¼ë¡œ ì„¸íŒ…ë˜ì§€ ì•Šê¸° ìœ„í•´ ë©”ì„œë“œë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public R newRecordIncludeNonNull(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  R newRecord = (R) readContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;Field&gt; fields = newRecord.fieldsRow().fieldStream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .map(r -&gt; TABLE.field(r.getName()))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  AtomicInteger i = new AtomicInteger(-1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  newRecord.valuesRow().fieldStream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .forEach(a -&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      i.addAndGet(1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      if (Objects.equals(a.getName(), &quot;null&quot;)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        newRecord.changed(fields.get(i.get()), false);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    });</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return newRecord;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public SelectConditionStep&lt;Record&gt; findBySelectorAndPojo(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;String&gt; selectors,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Object pojo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;Field&lt;Object&gt;&gt; fields = convertNamesToJooqFields(selectors);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  SelectConditionStep&lt;Record&gt; where = readContext.select(fields).from(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .where();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return addConditionToSelectStep(newRecordIncludeNonNull(pojo), where);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public int[] batchUpdate(List&lt;TablePojo&gt; tablePojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return writeContext.batchUpdate(tablePojo.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .map(this::newRecordIncludeNonNull)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(Collectors.toList())</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  ).execute();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pojo-ë¥¼-jooq-ë ˆì½”ë“œë¡œ-ë³€í™˜"></a>Pojo ë¥¼ jooq ë ˆì½”ë“œë¡œ ë³€í™˜<a class="hash-link" href="#pojo-ë¥¼-jooq-ë ˆì½”ë“œë¡œ-ë³€í™˜" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public R newRecord(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return (R) readContext.newRecord(TABLE, pojo);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="select-í• -ì»¬ëŸ¼ì„-jooq-í•„ë“œê°€-ì•„ë‹Œ-string-ìœ¼ë¡œ-ì§€ì •í• -ë•Œ"></a>select í•  ì»¬ëŸ¼ì„ Jooq í•„ë“œê°€ ì•„ë‹Œ String ìœ¼ë¡œ ì§€ì •í•  ë•Œ,<a class="hash-link" href="#select-í• -ì»¬ëŸ¼ì„-jooq-í•„ë“œê°€-ì•„ë‹Œ-string-ìœ¼ë¡œ-ì§€ì •í• -ë•Œ" title="Direct link to heading">#</a></h4><p><code>List&lt;String&gt;</code> ì—ì„œ <code>convertNamesToJooqFields</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë³€í™˜í•˜ë©´
fields ê°€ Jooq ì˜ TableField ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì œì•½ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public List&lt;Field&lt;Object&gt;&gt; convertNamesToJooqFields(List&lt;String&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return selectors.stream().map(DSL::field)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(Collectors.toList());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public SelectConditionStep&lt;Record&gt; findBySelectorAndPojo(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;String&gt; selectors,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Object pojo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;Field&lt;Object&gt;&gt; fields = convertNamesToJooqFields(selectors);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  SelectConditionStep&lt;Record&gt; where = readContext.select(fields).from(TABLE)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .where();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return addConditionToSelectStep(newRecordIncludeNonNull(pojo), where);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="jooqrecord-ë¡œ-condition-ë§Œë“¤ê¸°"></a>JooqRecord ë¡œ Condition ë§Œë“¤ê¸°<a class="hash-link" href="#jooqrecord-ë¡œ-condition-ë§Œë“¤ê¸°" title="Direct link to heading">#</a></h4><p><code>SelectConditionStep&lt;Record&gt; where</code> ë¥¼ ë°›ì§€ ì•Šê³  Codition ì„ ë°˜í™˜í•´ë„ ë©ë‹ˆë‹¤.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private SelectConditionStep&lt;Record&gt; addConditionToSelectStep(R record,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    SelectConditionStep&lt;Record&gt; where) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    List&lt;Object&gt; values = new ArrayList&lt;&gt;(record.map(r -&gt; r)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .intoMap()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .values());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Row fieldsRow = record.fieldsRow();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    for (Object o : values) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      if (isNull(o)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        continue;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int index = values.indexOf(o);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      where = where.and(((Field&lt;Object&gt;) fieldsRow.field(index)).eq(o));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return where;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public SelectConditionStep&lt;Record&gt; findByPojo(Object pojo) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return addConditionToSelectStep(newRecordIncludeNonNull(pojo), readContext.selectFrom(TABLE).where());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tablefield-ì—ì„œ-ì‚¬ìš©ëœ-table-ì°¾ê¸°"></a>TableField ì—ì„œ ì‚¬ìš©ëœ Table ì°¾ê¸°<a class="hash-link" href="#tablefield-ì—ì„œ-ì‚¬ìš©ëœ-table-ì°¾ê¸°" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Map&lt;? extends Table&lt;?&gt;, List&lt;TableField&lt;?, ?&gt;&gt;&gt; selectorsTableMapper(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;TableField&lt;?, ?&gt;&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return selectors.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(groupingBy(TableField::getTable));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">static Map&lt;Table, ? extends List&lt;? extends Field&lt;?&gt;&gt;&gt; selectorsFieldTableMapper(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  List&lt;? extends Field&lt;?&gt;&gt; selectors) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  return selectors.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .collect(groupingBy(r -&gt; ((TableField) r).getTable()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="selector-join-on-condition-ë‚˜ëˆ„ê¸°"></a>selector, join on, condition ë‚˜ëˆ„ê¸°<a class="hash-link" href="#selector-join-on-condition-ë‚˜ëˆ„ê¸°" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Builder</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@RequiredArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@AllArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class BaseSelectBuilder {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private final Select query;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private Condition condition = DSL.and();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private List&lt;Field&gt; selectors;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private Map&lt;Table, ? extends List&lt;? extends Field&gt;&gt; selectorsTableMapper;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private Map&lt;String, TableImpl&gt; aliasMap = new WeakHashMap&lt;&gt;();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private BiConsumer&lt;Query, Map&lt;Table, ? extends List&lt;? extends Field&gt;&gt;&gt; joiner;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public SelectConditionStep&lt;?&gt; compose() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    this.selectors = query.getSelect();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    this.selectorsTableMapper = selectorsFieldTableMapper();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    if (!isNull(joiner)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      joiner.accept(query, selectorsTableMapper);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return ((SelectJoinStep) query).where(condition);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public Map&lt;Table, ? extends List&lt;? extends Field&gt;&gt; selectorsFieldTableMapper() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return selectors.stream()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(groupingBy(r -&gt; ((TableField)r).getTable()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">BaseSelectBuilder.builder()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .query(readContext.select(Arrays.asList(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            TABLE.ID,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            TABLE2.VALUE</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          )).from(TABLE))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .condition(Condition Object)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .joiner(TableDaoJooqImpl::joinBuilder)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            .build()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              .compose()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                  .fetch()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public static void joinBuilder(Query query, Map&lt;Table, ? extends List&lt;? extends Field&gt;&gt; selectorsTableMapper) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  if (!isNull(selectorsTableMapper.get(TABLE2))) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    query = ((SelectJoinStep) query)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .join(TABLE2)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .on(TABLE.ID.eq(TABLE2.TABLE_ID));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ì—¬ëŸ¬-í…Œì´ë¸”ì˜-ì»¬ëŸ¼ì„-ê°€ì§€ê³ -ìˆëŠ”-record-ë¥¼-pojo-ê°ì²´ë¡œ-ë°”ì¸ë”©í•˜ê¸°"></a>ì—¬ëŸ¬ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì„ ê°€ì§€ê³  ìˆëŠ” Record ë¥¼ Pojo ê°ì²´ë¡œ ë°”ì¸ë”©í•˜ê¸°<a class="hash-link" href="#ì—¬ëŸ¬-í…Œì´ë¸”ì˜-ì»¬ëŸ¼ì„-ê°€ì§€ê³ -ìˆëŠ”-record-ë¥¼-pojo-ê°ì²´ë¡œ-ë°”ì¸ë”©í•˜ê¸°" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Slf4j</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Builder</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@NoArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@AllArgsConstructor</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Getter</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class Table implements TablePojo {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @Column(table = TABLE_NAME, name = &quot;id&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private Integer id;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private Table2 table2;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  //...</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public static ServicePage fromJooqRecord(Record record) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    JooqRecordMapper jooqRecordMapper = JooqRecordMapper.of(record);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    if (!jooqRecordMapper.hasTable(Table.TABLE_NAME)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      throw new EmptyResultDataAccessException(1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Table table = record.into(TABLE).into(Table.class);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    if (jooqRecordMapper.hasTable(Table2.TABLE_NAME)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      table.table2 = Table2.fromJooqRecord(record);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return table;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">```</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">```java</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// Ambigous SQL Warning ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•¨. jooq 3.11 version ì—ì„œëŠ” í•´ë‹¹ ê²½ê³ ë¥¼ ì„¤ì •ì„ í†µí•´ ì—†ì•¨ ìˆ˜ ì—†ìŒ. Info ë¡œê·¸ ë ˆë²¨ì—ì„œëŠ” ë¬´ì¡°ê±´ ë°œìƒ</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@RequiredArgsConstructor(staticName = &quot;of&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class JooqRecordMapper {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  private final Map&lt;String, String&gt; jooqRecordMapper;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public static JooqRecordMapper of(Record record) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Map&lt;String, String&gt; collect = Arrays.stream(record.fields())</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .map(a -&gt; a.getQualifiedName().getName()[0])</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      .collect(Collectors.toSet())</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        .stream().collect(Collectors.toMap(e -&gt; e, e -&gt; e));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return JooqRecordMapper.of(collect);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  public boolean hasTable(String tableName) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return !isNull(jooqRecordMapper.get(tableName.toLowerCase()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">```</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/java/data_structure/Map"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Map</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/java/transient_fields"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">transient fields ì„ì‹œ í•„ë“œ Â»</div></a></div></nav></div></div><div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ì˜ˆì œ" class="table-of-contents__link">ì˜ˆì œ</a></li><li><a href="#selector-join-on-condition-ë‚˜ëˆ„ê¸°" class="table-of-contents__link">selector, join on, condition ë‚˜ëˆ„ê¸°</a></li><li><a href="#ì—¬ëŸ¬-í…Œì´ë¸”ì˜-ì»¬ëŸ¼ì„-ê°€ì§€ê³ -ìˆëŠ”-record-ë¥¼-pojo-ê°ì²´ë¡œ-ë°”ì¸ë”©í•˜ê¸°" class="table-of-contents__link">ì—¬ëŸ¬ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì„ ê°€ì§€ê³  ìˆëŠ” Record ë¥¼ Pojo ê°ì²´ë¡œ ë°”ì¸ë”©í•˜ê¸°</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright Â© 2022 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.b715cea4.js"></script>
<script src="/runtime~main.01bf3f2f.js"></script>
<script src="/main.f85ec068.js"></script>
<script src="/1.878c926c.js"></script>
<script src="/3.052ff86c.js"></script>
<script src="/1be78505.641b6934.js"></script>
<script src="/412.ad32a78c.js"></script>
<script src="/935f2afb.0a816309.js"></script>
<script src="/409.2e79ec87.js"></script>
<script src="/17896441.12f0be0b.js"></script>
<script src="/3f987819.89f0bf38.js"></script>
</body>
</html>