<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Respect myself Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Respect myself Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Respect myself" href="/opensearch.xml"><title data-react-helmet="true">ITEM17 | Respect myself</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ITEM17 | Respect myself"><meta data-react-helmet="true" name="description" content="ITEM17 변경 가능성을 최소화하라"><meta data-react-helmet="true" property="og:description" content="ITEM17 변경 가능성을 최소화하라"><meta data-react-helmet="true" property="og:url" content="https://eyabc.github.io/docs/java/effective-java/ch4/ITEM17"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://YGAFWBIY5W-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://eyabc.github.io/docs/java/effective-java/ch4/ITEM17"><link rel="stylesheet" href="/styles.415acfaf.css">
<link rel="preload" href="/styles.f254da65.js" as="script">
<link rel="preload" href="/runtime~main.031a06c5.js" as="script">
<link rel="preload" href="/main.57a27d0b.js" as="script">
<link rel="preload" href="/1.dd298aaa.js" as="script">
<link rel="preload" href="/122.34812ad8.js" as="script">
<link rel="preload" href="/125.2981f218.js" as="script">
<link rel="preload" href="/935f2afb.42fd4b2b.js" as="script">
<link rel="preload" href="/121.1c488246.js" as="script">
<link rel="preload" href="/17896441.733d3737.js" as="script">
<link rel="preload" href="/16ffedbd.b5844035.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Respect myself" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Respect myself" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">나를 존중하는 시간</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self" href="/docs/javascript/index">JavaScript</a><ul class="dropdown__menu"><li><a target="_self" rel="noopener noreferrer" class="dropdown__link" href="/docs/java/effective-java/ch4/test">Facebook</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self">Java</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" type="doc" docid="effective-java" target="_self" href="/docs/java/effective-java">Effective Java</a></li><li><a class="dropdown__link" type="doc" docid="java-spring" target="_self" href="/docs/java/spring/index">Spring</a></li><li><a class="dropdown__link" type="doc" docid="java-etc" target="_self" href="/docs/java/etc/index">etc</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self">Study</a><ul class="dropdown__menu"><li><a class="dropdown__link" type="doc" docid="dku-javascript" target="_self" href="/docs/study/dku-javascript">DKU JavaScript</a></li></ul></div><a class="navbar__item navbar__link" target="_self" href="/docs/css/index">CSS</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" target="_self">Dev etc</a><ul class="dropdown__menu"><li><a class="dropdown__link" type="doc" docid="HTML" target="_self" href="/docs/html/index">HTML</a></li><li><a class="dropdown__link" type="doc" docid="network" target="_self" href="/docs/network/HTTP_headers_Referer_보안이슈">Network</a></li></ul></div><a class="navbar__item navbar__link" target="_self" href="/docs/etc/프로그래밍_어떻게_공부할_것인가">etc</a><a class="navbar__item navbar__link" target="_self" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/eyabc/eyabc.github.io" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Respect myself" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Respect myself" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">나를 존중하는 시간</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" target="_self" href="/docs/javascript/index">JavaScript</a><ul class="menu__list"><li class="menu__list-item"><a target="_self" rel="noopener noreferrer" class="menu__link" href="/docs/java/effective-java/ch4/test">Facebook</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist" target="_self">Java</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" type="doc" docid="effective-java" target="_self" href="/docs/java/effective-java">Effective Java</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="java-spring" target="_self" href="/docs/java/spring/index">Spring</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="java-etc" target="_self" href="/docs/java/etc/index">etc</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist" target="_self">Study</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" type="doc" docid="dku-javascript" target="_self" href="/docs/study/dku-javascript">DKU JavaScript</a></li></ul></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/css/index">CSS</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist" target="_self">Dev etc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" type="doc" docid="HTML" target="_self" href="/docs/html/index">HTML</a></li><li class="menu__list-item"><a class="menu__link" type="doc" docid="network" target="_self" href="/docs/network/HTTP_headers_Referer_보안이슈">Network</a></li></ul></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/docs/etc/프로그래밍_어떻게_공부할_것인가">etc</a></li><li class="menu__list-item"><a class="menu__link" target="_self" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/eyabc/eyabc.github.io" target="_self" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">ITEM17</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="item17-변경-가능성을-최소화하라"></a>ITEM17 변경 가능성을 최소화하라<a class="hash-link" href="#item17-변경-가능성을-최소화하라" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="불변클래스"></a>불변클래스<a class="hash-link" href="#불변클래스" title="Direct link to heading">#</a></h2><p>인스턴스 내부의 값을 수정할 수 없는 클래스</p><p>예시 </p><ul><li>String</li><li>기본타입의 박싱된 클래스</li><li>BigInteger</li><li>BigDecimal
...</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="불변-클래스로-설계하는-이유"></a>불변 클래스로 설계하는 이유<a class="hash-link" href="#불변-클래스로-설계하는-이유" title="Direct link to heading">#</a></h3><p>가변클래스보다 </p><ul><li>설계/구현/사용이 쉬움</li><li>오류가 더 적고 훨씬 안전함</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="불변-클래스로-만드는-방법"></a>불변 클래스로 만드는 방법<a class="hash-link" href="#불변-클래스로-만드는-방법" title="Direct link to heading">#</a></h3><ol><li>객체의 상태를 변경하는 메서드(변경자)를 제공하지 않기</li><li>클래스를 확장할 수 없도록 한다.<ul><li>하위클래스에서 부주의하게/나쁜의도로 객체의 상태를 변하게 하는 사태를 방지</li><li>final 클래스로 선언하는 방법</li></ul></li><li>모든 필드를 <strong>final</strong> 로 선언<ul><li>생성된 인스턴스를 동기화 없이 다른 스레드로 건네도 문제가 없다</li></ul></li><li>모든 필드를 <strong>private</strong> 으로 선언<ul><li>클라이언트에서 가변객체를 참조하는 필드를 수정하는 일을 방지</li><li>public final 로 선언한다면 다음 릴리스에서 내부 표현을 수정할 수 없다.</li></ul></li><li>자신 외에는 내부의 <strong>가변 컴포넌트</strong>에 접근할 수 없도록 한다.<ul><li>필드는 클라이언트의 객체 참조를 가리켜서는 안된다.</li><li>접근자 메서드로 가변 객체 필드를 반환하면 안된다.</li><li>생성자, 접근자, readObject 메서드 [88] 에서 방어적 복사를 수행해야 한다.</li></ul></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="함수형-프로그래밍과-절차형-프로그래밍"></a>함수형 프로그래밍과 절차형 프로그래밍<a class="hash-link" href="#함수형-프로그래밍과-절차형-프로그래밍" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="함수형-프로그래밍"></a>함수형 프로그래밍<a class="hash-link" href="#함수형-프로그래밍" title="Direct link to heading">#</a></h3><p>사칙연산 메서드들이 인스턴스 자신을 수정하지 않고 새로운 Complex 인스턴스를 만들어 반환한다</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public final class Complex {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    private final double re;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    private final double im;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public Complex(double re, double im) { ... }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public double realPart() { return re; }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public double imaginaryPart() { return im; }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public Complex plus(Complex c) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        return new Complex(re + c.re, im + c.im);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>피연산자에 함수를 적용해 그 결과를 반환하지만, 피연산자 자체는 그대로인 프로그래밍 패턴</strong></p><ul><li>동사(add) 대신 전치사(plus) 사용<ul><li>해당 메서드가 객체의 값을 변경하지 않는다는 사실을 강조함</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="절차적명령형-프로그래밍"></a>절차적(명령형) 프로그래밍<a class="hash-link" href="#절차적명령형-프로그래밍" title="Direct link to heading">#</a></h3><p>메서드에서 피연산자인 자신을 수정해 자신의 상태가 변하게 된다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="장점"></a>장점<a class="hash-link" href="#장점" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-스레드-안전-→-동기화-불필요"></a>1. 스레드 안전 → 동기화 불필요<a class="hash-link" href="#1-스레드-안전-→-동기화-불필요" title="Direct link to heading">#</a></h3><ul><li>안심하고 공유 가능</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-불변-인스턴스의-캐싱"></a>2. 불변 인스턴스의 캐싱<a class="hash-link" href="#2-불변-인스턴스의-캐싱" title="Direct link to heading">#</a></h3><ul><li>public static final 상수로 불변 인스턴스 제공<div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static final Complex ZERO = mew Complex(0, 0);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static final Complex ONE = new Complex(1, 0);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li><li>불변 클래스는 자주 사용되는 인스턴스를 캐싱하는 정적 팩터리를 제공할 수 있다.<ul><li>박싱된 기본 타입, BigInteger 의 특징</li><li>클라이언트가 인스턴스를 공유하여, 메모리 사용량과 가비지 컬렉션의 비용이 감소</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3-방어적-복사-불필요"></a>3. 방어적 복사 불필요<a class="hash-link" href="#3-방어적-복사-불필요" title="Direct link to heading">#</a></h3><ul><li>아무리 복사해도 원본과 같음</li><li>clone 메서드, 복사 생성자[13] 불필요</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4-불변-객체끼리는-내부-데이터를-공유할-수-있다"></a>4. 불변 객체끼리는 내부 데이터를 공유할 수 있다.<a class="hash-link" href="#4-불변-객체끼리는-내부-데이터를-공유할-수-있다" title="Direct link to heading">#</a></h3><p>BigInteger 클래스는 내부에서 </p><ul><li>값의 부호(sign)와 크기(magnitude) 를 따로 표현함</li><li>negate 메서드는 크기가 같고, 부호만 반대인 새로운 BigInteger 생성.</li><li>배열은 가변이지만, 원본 인스턴스와 공유하여 사용함.</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public class BigInteger extends Number implements Comparable&lt;BigInteger&gt; {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    final int signum;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    final int[] mag;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public BigInteger negate() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        return new BigInteger(this.mag, -this.signum);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5-객체를-만들-때-불변객체들을-구성요소로-사용하면-이점이-많다"></a>5. 객체를 만들 때 불변객체들을 구성요소로 사용하면 이점이 많다.<a class="hash-link" href="#5-객체를-만들-때-불변객체들을-구성요소로-사용하면-이점이-많다" title="Direct link to heading">#</a></h3><ul><li>구조가 아무리 복잡하더라도 불변식을 유지하기 훨씬 수월하다</li><li>불변 객체는 <strong>Map 의 키와</strong> <strong>Set 의 원소</strong> 에 적합하다</li><li>맵이나 집합은 담긴값이 바뀌면 불변식이 무너진다.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="6-불변객체는-그-자체로-실패-원자성을-제공한다76"></a>6. 불변객체는 그 자체로 실패 원자성을 제공한다[76]<a class="hash-link" href="#6-불변객체는-그-자체로-실패-원자성을-제공한다76" title="Direct link to heading">#</a></h3><p>실패원자성 failure atomicity</p><ul><li>메서드에서 예외가 발생한 후에도 그 객체는 여전히 유효한 상태여아 한다.</li></ul><p>상태가 변하지 않으니 잠깐이라도 불일치 상태에 빠질 가능성이 없다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="단점"></a>단점<a class="hash-link" href="#단점" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-값이-다르면-반드시-독립된-객체로-만들어야-한다"></a>1. 값이 다르면 반드시 독립된 객체로 만들어야 한다.<a class="hash-link" href="#1-값이-다르면-반드시-독립된-객체로-만들어야-한다" title="Direct link to heading">#</a></h3><ul><li>값의 가짓수가 많다면 모두 만드는데 큰 비용이 든다.</li></ul><p>filpBit 메서드는 새로운 BigInteger 인스턴스를 생성한다.</p><ul><li>원본과 단지 한비트만 다른 백만비트짜리 인스턴스 이다.</li><li>BigInteger의 크기에 비례해 시간과 공간을 소비한다.</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">BigInteger moby = ...;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">mody = moby.filpBit(0);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>BitSet</p><ul><li>BigInteger 처럼 임의 길이의 비트 순열도 표현</li><li>BigInteger 와 달리 가변이다.</li><li>비트 하나만 상수 시간안에 바꾸는 메서드를 제공한다.</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">BitSet moby = ...;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">moby.flip(0);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-성능-문제"></a>2. 성능 문제<a class="hash-link" href="#2-성능-문제" title="Direct link to heading">#</a></h3><ul><li>원하는 객체를 완성하기까지의 단계가 많다</li><li>그 중간 단계에서 만들어진 객체들이 모두 버려진다면 성능 문제가 불거진다.</li></ul><p>대처방법</p><ol><li>다단계 연산들을 예측하여 기본 기능으로 제공한다.<ul><li>각 단계마다 객체를 생성하지 않아도 된다 </li><li>BigInteger 는 모듈러 지수 같은 다단계 연산 속도를 높여주는 가변 동반 클래스 companion class 를 package-private 으로 두고 있다.</li><li>String 클래스의 가변 동반 클래스는 StringBuilder 와 StringBuffer</li></ul></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="불변-클래스를-만드는-방법"></a>불변 클래스를 만드는 방법<a class="hash-link" href="#불변-클래스를-만드는-방법" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="생성자-대신-정적-팩터리를-사용한-불변-클래스"></a>생성자 대신 정적 팩터리를 사용한 불변 클래스<a class="hash-link" href="#생성자-대신-정적-팩터리를-사용한-불변-클래스" title="Direct link to heading">#</a></h3><p>자신을 상속하지 못하게 할 수 있다. (하위 클래스에서 상위 클래스의 생성자를 호출하지 못하므로)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public class Complex {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // ... 불변 필드</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    private Complex(double re, double im) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        this.re = re;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        this.im = im;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public static Complex valueOf(double re, double im) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        return new Complex(re, im);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>이 방법이 최선일 때가 많다</li></ul><p>BigInteger 와 BigDecimal</p><ul><li>설계할 당시, 불변 객체가 사실상 final 이어야 한 다는 생각이 널리 퍼지지 않았음</li><li>두 클래스의 메서드 들은 모두 재정의할 수 있게 설계되었으며, 하위 호환성이 지금까지 발목을 잡고 있다</li><li>이 인수들은 가변이라 가정하고 방어적으로 복사해 사용해야 한다</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="유연성"></a>유연성<a class="hash-link" href="#유연성" title="Direct link to heading">#</a></h2><p>&quot;모든 필드는 final 이고 어떤 메서드도 그 객체를 수정할 수 없어야 한다&quot;<br>
성능을 위해 다음처럼 살짝 완화해야 한다.</p><p>지연 초기화</p><ul><li>어떤 불변 클래스는 계산 비용이 큰 값을 나중에 계산하여 final 이 아닌 필드에 캐시 할 수 있다.</li><li>PhoneNumber 의 hashCode 메서드[11]는 처음 불렸을 때 해시 값을 계산해 캐시함 </li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="직렬화의-주의점"></a>직렬화의 주의점<a class="hash-link" href="#직렬화의-주의점" title="Direct link to heading">#</a></h2><p>Serializable 을 구현하는 불변 클래스의 내부에 가변 객체를 참조하는 필드가 있다면,</p><ul><li>readObject, readResolve 메서드를 반드시 제공하거나</li><li>ObjectOutputStream.writeUnshared 와 ObjectInputStream.readUnshared 메서드를 사용해야 한다.</li></ul><p>그렇지 않으면, 공격자가 이 클래스로부터 가변 인스턴스를 만들어 낼 수 있다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="타협점"></a>타협점<a class="hash-link" href="#타협점" title="Direct link to heading">#</a></h2><p>클래스는 꼭 필요한 경우가 아니라면 불변이어야 한다.</p><ul><li>불변 클래스는 장점이 많으며, 단점이라곤 특정 상황에서의 잠재적 성능 저하 뿐이다.</li><li>단순한 값 객체는 항상 불변으로 만들자</li><li>성능 때문에 어쩔 수 없다면 불변 클래스와 쌍을 이루는 가변 동반 클래스를 public 클래스로 제공하자 ??</li><li>불변으로 만들 수 없는 클래스라도 변경할 수 있는 부분을 최소화</li><li>객체가 가질 수 있는 상태의 수를 줄이면, 그 객체를 예측하기 쉬워지고 오류가 생길 가능성 감소</li><li>꼭 변경해야 할 필드를 뺀 나머지 모두를 final 로 선언</li><li>다른 합당한 이유가 없다면 모든 필드는 private final 이어야 한다.</li><li>생성자는 불변식 설정이 모두 완료된, 초기화가 완벽히 끝난 상태의 객체를 생성해야 한다.</li><li>확실한 이유가 없다면 생성자와 정적 팩터리 외에는 그 어떤 초기화 메서드도 public 으로 제공해서는 안된다.</li><li>객체를 재활용할 목적으로 상태를 다시 초기화 하는 메서드도 안된다.</li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#불변클래스" class="table-of-contents__link">불변클래스</a><ul><li><a href="#불변-클래스로-설계하는-이유" class="table-of-contents__link">불변 클래스로 설계하는 이유</a></li><li><a href="#불변-클래스로-만드는-방법" class="table-of-contents__link">불변 클래스로 만드는 방법</a></li></ul></li><li><a href="#함수형-프로그래밍과-절차형-프로그래밍" class="table-of-contents__link">함수형 프로그래밍과 절차형 프로그래밍</a><ul><li><a href="#함수형-프로그래밍" class="table-of-contents__link">함수형 프로그래밍</a></li><li><a href="#절차적명령형-프로그래밍" class="table-of-contents__link">절차적(명령형) 프로그래밍</a></li></ul></li><li><a href="#장점" class="table-of-contents__link">장점</a><ul><li><a href="#1-스레드-안전-→-동기화-불필요" class="table-of-contents__link">1. 스레드 안전 → 동기화 불필요</a></li><li><a href="#2-불변-인스턴스의-캐싱" class="table-of-contents__link">2. 불변 인스턴스의 캐싱</a></li><li><a href="#3-방어적-복사-불필요" class="table-of-contents__link">3. 방어적 복사 불필요</a></li><li><a href="#4-불변-객체끼리는-내부-데이터를-공유할-수-있다" class="table-of-contents__link">4. 불변 객체끼리는 내부 데이터를 공유할 수 있다.</a></li><li><a href="#5-객체를-만들-때-불변객체들을-구성요소로-사용하면-이점이-많다" class="table-of-contents__link">5. 객체를 만들 때 불변객체들을 구성요소로 사용하면 이점이 많다.</a></li><li><a href="#6-불변객체는-그-자체로-실패-원자성을-제공한다76" class="table-of-contents__link">6. 불변객체는 그 자체로 실패 원자성을 제공한다76</a></li></ul></li><li><a href="#단점" class="table-of-contents__link">단점</a><ul><li><a href="#1-값이-다르면-반드시-독립된-객체로-만들어야-한다" class="table-of-contents__link">1. 값이 다르면 반드시 독립된 객체로 만들어야 한다.</a></li><li><a href="#2-성능-문제" class="table-of-contents__link">2. 성능 문제</a></li></ul></li><li><a href="#불변-클래스를-만드는-방법" class="table-of-contents__link">불변 클래스를 만드는 방법</a><ul><li><a href="#생성자-대신-정적-팩터리를-사용한-불변-클래스" class="table-of-contents__link">생성자 대신 정적 팩터리를 사용한 불변 클래스</a></li></ul></li><li><a href="#유연성" class="table-of-contents__link">유연성</a></li><li><a href="#직렬화의-주의점" class="table-of-contents__link">직렬화의 주의점</a></li><li><a href="#타협점" class="table-of-contents__link">타협점</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright © 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.f254da65.js"></script>
<script src="/runtime~main.031a06c5.js"></script>
<script src="/main.57a27d0b.js"></script>
<script src="/1.dd298aaa.js"></script>
<script src="/122.34812ad8.js"></script>
<script src="/125.2981f218.js"></script>
<script src="/935f2afb.42fd4b2b.js"></script>
<script src="/121.1c488246.js"></script>
<script src="/17896441.733d3737.js"></script>
<script src="/16ffedbd.b5844035.js"></script>
</body>
</html>